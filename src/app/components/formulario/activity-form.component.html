<div class="grid-container">
  <h1 class="mat-h1">Submeter atividade</h1>
  <mat-card class="shipping-card">
    <mat-accordion class="expand">
      <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
        <mat-expansion-panel-header (focus)="definetipoAtividade('Convênios')">
          <mat-panel-title> Convênios </mat-panel-title>
          <mat-panel-description>
            Submeter atividades de convênios
          </mat-panel-description>
        </mat-expansion-panel-header>
        <form name="form" [formGroup]="convenioForm" #f="ngForm">
          <input matInput placeholder="hidden" formControlName="hidden" hidden style="margin: 0 0 !important;" />
          <mat-card class="mat-elevation-z0">
            <mat-card-content>
              <div class="row">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Título do Projeto (obrigatório):</mat-label>
                    <input matInput placeholder="Título do Projeto (obrigatório)" formControlName="projeto" />
                    <mat-error *ngIf="convenioForm.controls['projeto'].hasError('required')">
                      Nome ou titulo do projeto <strong>obrigatório</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Instituição de Ensino (obrigatório):</mat-label>
                    <input matInput placeholder="Instituição de Ensino (obrigatório)" formControlName="instituicao" />
                    <mat-error *ngIf="
                        convenioForm.controls['instituicao'].hasError(
                          'required'
                        )
                      ">
                      Nome da instituição <strong>obrigatório</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Coordenador(a) (opcional):</mat-label>
                    <input matInput placeholder="Coordenador(a) (opcional)" formControlName="coordenador" />
                    <!-- <mat-error *ngIf="
                        convenioForm.controls['coordenador'].hasError(
                          'required'
                        )
                      ">
                      Nome do coordenador(a) <strong>obrigatório</strong>
                    </mat-error> -->
                  </mat-form-field>
                </div>
              </div>
              <div class="row">
                <mat-label style="margin-right: 20px">Participação (obrigatório):
                </mat-label>
                <mat-radio-group aria-label="Select an option" formControlName="tipoAtividadeSimultanea">
                  <mat-radio-button value="PESQUISA">Pesquisa</mat-radio-button>
                  <mat-radio-button value="ENSINO">Ensino</mat-radio-button>
                  <mat-radio-button value="EXTENSAO">Extensão</mat-radio-button>
                </mat-radio-group>
                <mat-error *ngIf="convenioForm.controls['tipoAtividadeSimultanea'].hasError('required')">Campo
                  obrigatório.</mat-error>
              </div>
              <div class="row">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Descrição (obrigatório):</mat-label>
                    <input matInput placeholder="Descrição (obrigatório)" formControlName="descricao" />
                  </mat-form-field>
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Data Inicio (obrigatório):</mat-label>
                    <input matInput [matDatepicker]="picker" formControlName="dataInicio"
                      placeholder="Data Inicio (obrigatório)" required />
                    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                    <mat-datepicker #picker></mat-datepicker>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Data Fim (obrigatório):</mat-label>
                    <!--(selectionChange)="updateDate($event)" (change)="updateDate($event)" (keyup)="updateDate($event)" [min]="minDateFim" [max]="maxDateFim"-->
                    <input matInput [matDatepicker]="picker1" formControlName="dataFim"
                      placeholder="Data Fim (obrigatório)" [min]="minDateFim" required />
                    <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                    <mat-datepicker #picker1></mat-datepicker>
                  </mat-form-field>
                </div>

                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Valor bruto (R$) (obrigatório): </mat-label>
                    <input matInput maxlength="5" min="0" placeholder="Valor bruto (R$) (obrigatório)" type="number"
                      formControlName="valorBruto" />
                  </mat-form-field>
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline" matTooltip="Carga horária semanal"
                    matTooltipPosition="right">
                    <mat-label>Qtd. Horas semanais (obrigatório):</mat-label>
                    <input matInput placeholder="Qtd. Horas semanais (obrigatório)" type="number"
                      formControlName="horaSemanal" [(ngModel)]="hrSemanalConvenio"
                      (keyup)="updateMensalConvenio($event)" required />
                    <mat-error *ngIf="convenioForm.controls['horaSemanal'].hasError('max')">
                      Máximo são <strong>{{max_hr_semanais_convenio}}h/semanais.</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Qtd. Horas mensais (obrigatório):</mat-label>
                    <input matInput min="4" placeholder="Qtd. Horas mensais (obrigatório)" type="number"
                      formControlName="horaMensal" [(ngModel)]="hrMensalConvenio"
                      (keyup)="updateSemanalConvenio($event)" required />
                    <mat-error *ngIf="convenioForm.controls['horaMensal'].hasError('max')">
                      Máximo são <strong>{{max_hr_mensais_convenio}}h/mensais.</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>

              <h3>Alocação (obrigatório)</h3> <mat-icon *ngIf="loading$ | async"><mat-spinner color="accent" diameter="20"> </mat-spinner> </mat-icon>
              <!-- debug: <br>
                hr: {{extra[0]}} semestre: {{extra[3]}} ano: {{extra[4]}} <br>
              hr1: {{extra1[0]}} semestre: {{extra1[3]}} ano: {{extra1[4]}} <br>
              hr2: {{extra2[0]}} semestre: {{extra2[3]}} ano: {{extra2[4]}} <br>
              hr3: {{extra3[0]}} semestre: {{extra3[3]}} ano: {{extra3[4]}} <br>
              hr4: {{extra4[0]}} semestre: {{extra4[3]}} ano: {{extra4[4]}} <br>
              hr5: {{extra5[0]}} semestre: {{extra5[3]}} ano: {{extra5[4]}} <br> -->
              <div class="alocacao-row">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Semestre</mat-label>
                    <mat-select formControlName="semestre" (selectionChange)="hrRestantes(0)" required>
                      <mat-option value="0">Selecione o semestre:</mat-option>
                      <mat-option value="1">1o Semestre</mat-option>
                      <mat-option value="2">2o Semestre</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Ano</mat-label>
                    <mat-select formControlName="ano" (selectionChange)="hrRestantes(0)" required>
                      <mat-option value="0">Selecione o ano:</mat-option>
                      <mat-option value="{{ ano }}">{{ ano }}</mat-option>
                      <mat-option value="{{ ano+1 }}">{{ ano+1 }}</mat-option>
                      <mat-option value="{{ ano+2 }}">{{ ano+2 }}</mat-option>
                      <mat-option value="{{ ano+3 }}">{{ ano+3 }}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                
                <div class="hr-disponiveis" *ngIf="extra[0] != null">
                  <mat-icon matBadge="{{max_hr_semestrais_convenio-extra[0]}}" matBadgeColor="accent" matTooltip="Horas disponíveis nesse semestre para {{tipoAtividade}}">assessment</mat-icon>
                </div>
                
                <div class="col">
                  <mat-form-field class="full-width" class="horas" appearance="outline">                     
                    <mat-label>Horas</mat-label>
                    <input matInput placeholder="Horas" type="number" (keyup)="confereSoma()" (keyup)="consultaHrAlocacoes(1,$event,0)" formControlName="horasSolicitadas" required /> 
                    
                    <mat-error *ngIf="convenioForm.controls['horasSolicitadas'].hasError('max')">Máximo são <strong>{{max_hr_semestrais_convenio}}h/semestre.</strong>
                    </mat-error>
                  </mat-form-field>
                  <button mat-button type="button" mat-icon-button *ngIf="excedeuHr" color="warn" matTooltip="Excedeu"><mat-icon>warning</mat-icon></button>
                  <button mat-button type="button" mat-icon-button (click)="alocacaoExtra = !alocacaoExtra"
                    *ngIf="!alocacaoExtra" [disabled]="convenioForm.controls.horasSolicitadas.errors?.max">
                    <mat-icon>add_circle</mat-icon>
                  </button>
                </div>
                
              </div>

              <!-- Alocação Extra -->
              <div class="row" *ngIf="alocacaoExtra">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Semestre</mat-label>
                    <mat-select formControlName="semestre1" (selectionChange)="hrRestantes(1)" required>
                      <mat-option value="0">Selecione o semestre:</mat-option>
                      <mat-option value="1">1o Semestre</mat-option>
                      <mat-option value="2">2o Semestre</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Ano</mat-label>
                    <mat-select formControlName="ano1" (selectionChange)="hrRestantes(1)" required>
                      <mat-option value="0">Selecione o ano:</mat-option>
                      <mat-option value="{{ ano }}">{{ ano }}</mat-option>
                      <mat-option value="{{ ano+1 }}">{{ ano+1 }}</mat-option>
                      <mat-option value="{{ ano+2 }}">{{ ano+2 }}</mat-option>
                      <mat-option value="{{ ano+3 }}">{{ ano+3 }}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>

                <div class="hr-disponiveis" *ngIf="extra1[0] != null">
                  <mat-icon matBadge="{{max_hr_semestrais_convenio-extra1[0]}}" matBadgeColor="accent" matTooltip="Horas disponíveis nesse semestre para {{tipoAtividade}}">assessment</mat-icon>
                </div>

                <div class="col">
                  <mat-form-field class="full-width" class="horas" appearance="outline">
                    <mat-label>Horas</mat-label>
                    <input matInput min="1" placeholder="Horas" type="number" (keyup)="confereSoma()" (keyup)="consultaHrAlocacoes(1,$event,1)" formControlName="horasSolicitadas1" required />
                    <mat-error *ngIf="convenioForm.controls['horasSolicitadas1'].hasError('max')"> 
                      Máximo são <strong>60h/semestre.</strong>
                    </mat-error>
                  </mat-form-field>
                  <button mat-button type="button" mat-icon-button *ngIf="excedeuHr1" color="warn" matTooltip="Excedeu"><mat-icon>warning</mat-icon></button>
                  <button mat-button type="button" mat-icon-button (click)="alocacaoExtra2 = !alocacaoExtra2"
                    *ngIf="!alocacaoExtra2" [disabled]="convenioForm.controls.horasSolicitadas1.errors?.max"
                   >
                    <mat-icon>add_circle</mat-icon>
                  </button>
                  <button mat-button type="button" mat-icon-button aria-label="Clear" (click)="resetHrExtra(1)"
                    (click)="alocacaoExtra = !alocacaoExtra">
                    <mat-icon>remove_circle_outline</mat-icon>
                  </button>
                </div>
              </div>

              <div class="row" *ngIf="alocacaoExtra2">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Semestre</mat-label>
                    <mat-select formControlName="semestre2" (selectionChange)="hrRestantes(2)" required>
                      <mat-option value="0">Selecione o semestre:</mat-option>
                      <mat-option value="1">1o Semestre</mat-option>
                      <mat-option value="2">2o Semestre</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Ano</mat-label>
                    <mat-select formControlName="ano2" (selectionChange)="hrRestantes(2)" required>
                      <mat-option value="0">Selecione o ano:</mat-option>
                      <mat-option value="{{ ano }}">{{ ano }}</mat-option>
                      <mat-option value="{{ ano+1 }}">{{ ano+1 }}</mat-option>
                      <mat-option value="{{ ano+2 }}">{{ ano+2 }}</mat-option>
                      <mat-option value="{{ ano+3 }}">{{ ano+3 }}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>

                <div class="hr-disponiveis" *ngIf="extra2[0] != null">
                  <mat-icon matBadge="{{max_hr_semestrais_convenio-extra2[0]}}" matBadgeColor="accent" matTooltip="Horas disponíveis nesse semestre para {{tipoAtividade}}">assessment</mat-icon>
                </div>

                <div class="col">
                  <mat-form-field class="full-width" class="horas" appearance="outline">
                    <mat-label>Horas</mat-label>
                    <input matInput min="1" placeholder="Horas" type="number" formControlName="horasSolicitadas2" (keyup)="confereSoma()" (keyup)="consultaHrAlocacoes(1,$event,2)" required /> 
                    <mat-error *ngIf="convenioForm.controls['horasSolicitadas2'].hasError('max')">
                      Máximo são <strong>60h/semestre.</strong>
                    </mat-error>
                  </mat-form-field>
                  <button mat-button type="button" mat-icon-button *ngIf="excedeuHr2" color="warn" matTooltip="Excedeu"><mat-icon>warning</mat-icon></button>
                  <button mat-button type="button" mat-icon-button
                    (click)="alocacaoExtra3 = !alocacaoExtra3" *ngIf="!alocacaoExtra3"
                    [disabled]="convenioForm.controls.horasSolicitadas2.errors?.max">
                    <mat-icon>add_circle</mat-icon>
                  </button>
                  <button mat-button type="button" mat-icon-button aria-label="Clear"
                    (click)="alocacaoExtra2 = !alocacaoExtra2" (click)="resetHrExtra(2)">
                    <mat-icon>remove_circle_outline</mat-icon>
                  </button>
                </div>
              </div>

              <div class="row" *ngIf="alocacaoExtra3">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Semestre</mat-label>
                    <mat-select formControlName="semestre3" (selectionChange)="hrRestantes(3)" required>
                      <mat-option value="0">Selecione o semestre:</mat-option>
                      <mat-option value="1">1o Semestre</mat-option>
                      <mat-option value="2">2o Semestre</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Ano</mat-label>
                    <mat-select formControlName="ano3" (selectionChange)="hrRestantes(3)" required>
                      <mat-option value="0">Selecione o ano:</mat-option>
                      <mat-option value="{{ ano }}">{{ ano }}</mat-option>
                      <mat-option value="{{ ano+1 }}">{{ ano+1 }}</mat-option>
                      <mat-option value="{{ ano+2 }}">{{ ano+2 }}</mat-option>
                      <mat-option value="{{ ano+3 }}">{{ ano+3 }}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>

                <div class="hr-disponiveis" *ngIf="extra3[0] != null">
                  <mat-icon matBadge="{{max_hr_semestrais_convenio-extra3[0]}}" matBadgeColor="accent" matTooltip="Horas disponíveis nesse semestre para {{tipoAtividade}}">assessment</mat-icon>
                </div>

                <div class="col">
                  <mat-form-field class="full-width" class="horas" appearance="outline">
                    <mat-label>Horas</mat-label>
                    <input matInput min="1" placeholder="Horas" type="number" formControlName="horasSolicitadas3" (keyup)="confereSoma()" (keyup)="consultaHrAlocacoes(1,$event,3)" required /> 
                    <mat-error *ngIf="convenioForm.controls['horasSolicitadas3'].hasError('max')">
                      Máximo são <strong>60h/semestre.</strong>
                    </mat-error>
                  </mat-form-field>
                  <button mat-button type="button" mat-icon-button *ngIf="excedeuHr3" color="warn" matTooltip="Excedeu"><mat-icon>warning</mat-icon></button>
                  <button mat-button type="button" mat-icon-button (click)="alocacaoExtra4 = !alocacaoExtra4"
                    *ngIf="!alocacaoExtra4" [disabled]="convenioForm.controls.horasSolicitadas3.errors?.max"
                   >
                    <mat-icon>add_circle</mat-icon>
                  </button>
                  <button mat-button type="button" mat-icon-button aria-label="Clear"
                    (click)="alocacaoExtra3 = !alocacaoExtra3" (click)="resetHrExtra(3)">
                    <mat-icon>remove_circle_outline</mat-icon>
                  </button>
                </div>
              </div>

              <div class="row" *ngIf="alocacaoExtra4">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Semestre</mat-label>
                    <mat-select formControlName="semestre4" (selectionChange)="hrRestantes(4)" required>
                      <mat-option value="0">Selecione o semestre:</mat-option>
                      <mat-option value="1">1o Semestre</mat-option>
                      <mat-option value="2">2o Semestre</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Ano</mat-label>
                    <mat-select formControlName="ano4" (selectionChange)="hrRestantes(4)" required>
                      <mat-option value="0">Selecione o ano:</mat-option>
                      <mat-option value="{{ ano }}">{{ ano }}</mat-option>
                      <mat-option value="{{ ano+1 }}">{{ ano+1 }}</mat-option>
                      <mat-option value="{{ ano+2 }}">{{ ano+2 }}</mat-option>
                      <mat-option value="{{ ano+3 }}">{{ ano+3 }}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>

                <div class="hr-disponiveis" *ngIf="extra4[0] != null">
                  <mat-icon matBadge="{{max_hr_semestrais_convenio-extra4[0]}}" matBadgeColor="accent" matTooltip="Horas disponíveis nesse semestre para {{tipoAtividade}}">assessment</mat-icon>
                </div>

                <div class="col">
                  <mat-form-field class="full-width" class="horas" appearance="outline">
                    <mat-label>Horas</mat-label>
                    <input matInput min="1" placeholder="Horas" type="number" formControlName="horasSolicitadas4" (keyup)="confereSoma()" (keyup)="consultaHrAlocacoes(1,$event,4)" required /> 
                    <mat-error *ngIf="convenioForm.controls['horasSolicitadas4'].hasError('max')">
                      Máximo são <strong>60h/semestre.</strong>
                    </mat-error>
                  </mat-form-field>
                  <button mat-button type="button" mat-icon-button *ngIf="excedeuHr4" color="warn" matTooltip="Excedeu"><mat-icon>warning</mat-icon></button>
                  <button mat-button type="button" mat-icon-button (click)="alocacaoExtra5 = !alocacaoExtra5"
                    *ngIf="!alocacaoExtra5" [disabled]="convenioForm.controls.horasSolicitadas4.errors?.max"
                   >
                    <mat-icon>add_circle</mat-icon>
                  </button>
                  <button mat-button type="button" mat-icon-button aria-label="Clear"
                    (click)="alocacaoExtra4 = !alocacaoExtra4" (click)="resetHrExtra(4)">
                    <mat-icon>remove_circle_outline</mat-icon>
                  </button>
                </div>
              </div>

              <div class="row" *ngIf="alocacaoExtra5">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Semestre</mat-label>
                    <mat-select formControlName="semestre5" (selectionChange)="hrRestantes(5)" required>
                      <mat-option value="0">Selecione o semestre:</mat-option>
                      <mat-option value="1">1o Semestre</mat-option>
                      <mat-option value="2">2o Semestre</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Ano</mat-label>
                    <mat-select formControlName="ano5" (selectionChange)="hrRestantes(5)" required>
                      <mat-option value="0">Selecione o ano:</mat-option>
                      <mat-option value="{{ ano }}">{{ ano }}</mat-option>
                      <mat-option value="{{ ano+1 }}">{{ ano+1 }}</mat-option>
                      <mat-option value="{{ ano+2 }}">{{ ano+2 }}</mat-option>
                      <mat-option value="{{ ano+3 }}">{{ ano+3 }}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>

                <div class="hr-disponiveis" *ngIf="extra5[0] != null">
                  <mat-icon matBadge="{{max_hr_semestrais_convenio-extra5[0]}}" matBadgeColor="accent" matTooltip="Horas disponíveis nesse semestre para {{tipoAtividade}}">assessment</mat-icon>
                </div>

                <div class="col">
                  <mat-form-field class="full-width" class="horas" appearance="outline">
                    <mat-label>Horas</mat-label>
                    <input matInput min="1" placeholder="Horas" type="number" formControlName="horasSolicitadas5" (keyup)="confereSoma()" (keyup)="consultaHrAlocacoes(1,$event,5)" required /> 
                    <mat-error *ngIf="convenioForm.controls['horasSolicitadas5'].hasError('max')">
                      Máximo são <strong>60h/semestre.</strong>
                    </mat-error>
                  </mat-form-field>
                  <button mat-button type="button" mat-icon-button *ngIf="excedeuHr5" color="warn" matTooltip="Excedeu"><mat-icon>warning</mat-icon></button>
                  <button mat-button type="button" mat-icon-button aria-label="Clear"
                    (click)="alocacaoExtra5 = !alocacaoExtra5" (click)="resetHrExtra(5)"
                    [disabled]="convenioForm.controls.horasSolicitadas5.errors?.max">
                    <mat-icon>remove_circle_outline</mat-icon>
                  </button>
                </div>
              </div>

              <h3>Observações (opcional):</h3>
              <div class="row">
                <div class="col">
                  <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Incluir observação</mat-label>
                    <textarea matInput formControlName="observacao"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row" style="margin-bottom: 20px;">
                <div class="col">
                  <mat-slide-toggle formControlName="urgente">Urgente</mat-slide-toggle>
                </div>
              </div>
              <!-- <div class="row">
                <div class="col">
                  <label class="btn btn-default">
                    <input type="file" (change)="selecionarArquivo($event)" />
                  </label>
                </div>
              </div> -->
            </mat-card-content>
            <mat-card-actions>
              <button [disabled]="!convenioForm.valid || totalHrSolicitadas != somaHrConvenio" mat-raised-button
                color="primary" (click)="submeterConvenio(); convenioForm.reset()" *ngIf="!excedeuHr && !excedeuHr1 && !excedeuHr2 && !excedeuHr3 && !excedeuHr4 && !excedeuHr5">
                Enviar
              </button>

              <button [disabled]="!convenioForm.valid || totalHrSolicitadas != somaHrConvenio" mat-raised-button
                color="primary" (click)="submeterConvenio(); convenioForm.reset()" *ngIf="excedeuHr || excedeuHr1 || excedeuHr2 || excedeuHr3 || excedeuHr4 || excedeuHr5"
                matBadge="⚠" matBadgeColor="accent">
                Enviar
              </button>
            </mat-card-actions>

            <mat-card-actions><mat-error *ngIf="!convenioForm.valid">Existem campos obrigatórios sem preencher ou incorretos. <button mat-button (click)="convenioForm.markAllAsTouched();">Quais?</button></mat-error>
              <mat-error *ngIf="totalHrSolicitadas != somaHrConvenio">Total de horas alocadas não batem.</mat-error>
            </mat-card-actions>
          </mat-card>
        </form>
      </mat-expansion-panel>

      <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
        <mat-expansion-panel-header (focus)="definetipoAtividade('Cursos')">
          <mat-panel-title> Cursos </mat-panel-title>
          <mat-panel-description>
            Submeter atividades relacionadas ao cursos de extensão universitária
          </mat-panel-description>
        </mat-expansion-panel-header>
        <form name="form" [formGroup]="cursoForm" #f="ngForm">
          <mat-card class="mat-elevation-z0">
            <mat-card-content>
              <div class="row">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Nome do curso (obrigatório):</mat-label>
                    <input matInput placeholder="Nome do curso (obrigatório)" formControlName="nomeCurso" />
                    <mat-error *ngIf="cursoForm.controls['nomeCurso'].hasError('required')"> Nome do curso
                      <strong>obrigatório</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Instituição de Ensino (obrigatório):</mat-label>
                    <input matInput placeholder="Instituição de Ensino (obrigatório)"
                      formControlName="instituicaoVinculada" />
                    <mat-error *ngIf="cursoForm.controls['instituicaoVinculada'].hasError('required')">
                      Nome da instituição <strong>obrigatório</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Coordenador(a) (opcional):</mat-label>
                    <input matInput placeholder="Coordenador(a) (opcional)" formControlName="coordenador" />
                    <!-- <mat-error *ngIf="
                        cursoForm.controls['coordenador'].hasError('required')
                      ">
                      Nome do coordenador(a) <strong>obrigatório</strong>
                    </mat-error> -->
                  </mat-form-field>
                </div>
              </div>
              <div class="row">
                <mat-label style="margin-right: 20px">Participação (obrigatório):
                </mat-label>
                <mat-radio-group aria-label="Select an option" formControlName="participacao" (change)="setRequired()">
                  <mat-radio-button value="DISCIPLINA">Disciplina</mat-radio-button>
                  <mat-radio-button value="COORDENACAO" >Coordenação</mat-radio-button>
                </mat-radio-group>
                <mat-error *ngIf="cursoForm.controls['participacao'].hasError('required')">Campo
                  obrigatório.</mat-error>
              </div>
              <div class="row" style="margin-top: 5px">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Disciplina de participação (opcional):</mat-label>
                    <input matInput placeholder="Disciplina de participação (opcional)" formControlName="disciplina" />
                  </mat-form-field>
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Carga horária total de aulas ministradas:</mat-label>
                    <input matInput maxlength="3" min="1"
                      placeholder="Carga horária total de aulas ministradas" type="number"
                      formControlName="totalHorasMinistradas" [(ngModel)]="hrTotalMinistradaCurso" (keyup)="updateSomaHrCurso()" />
                    <mat-error *ngIf="cursoForm.controls['totalHorasMinistradas'].hasError('max')">
                      Máximo são <strong>{{max_hr_ministradas_curso}} horas.</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Carga horária total de outras atividades:</mat-label>
                    <input matInput maxlength="5" min="1"
                      placeholder="Carga horária total de outras atividades" type="number"
                      formControlName="totalHorasOutrasAtividades" [(ngModel)]="hrTotalOutrasCurso" (keyup)="updateSomaHrCurso()" />
                    <mat-error *ngIf="cursoForm.controls['totalHorasOutrasAtividades'].hasError('max')">
                      Máximo são <strong>240 horas.</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Valor bruto por hora (R$) (opcional):</mat-label>
                    <input matInput maxlength="5" placeholder="Valor bruto por hora (R$) (opcional)" type="number"
                      formControlName="valorBrutoHora" />
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Valor bruto total (R$) (opcional):</mat-label>
                    <input matInput maxlength="5" placeholder="Valor bruto total (R$) (opcional)" type="number"
                      formControlName="valorBrutoTotal" />
                  </mat-form-field>
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Data Início (obrigatório):</mat-label>
                    <!--[min]="minDateIni" [max]="maxDateIni"-->
                    <input matInput [matDatepicker]="picker2" formControlName="dataInicio"
                      placeholder="Data Início (obrigatório)" required />
                    <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                    <mat-datepicker #picker2></mat-datepicker>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Data Fim (obrigatório):</mat-label>
                    <input matInput [matDatepicker]="picker3" formControlName="dataFim"
                      placeholder="Data Fim (obrigatório)" [min]="minDateFim" required />
                    <mat-datepicker-toggle matSuffix [for]="picker3"></mat-datepicker-toggle>
                    <mat-datepicker #picker3></mat-datepicker>
                  </mat-form-field>
                </div>
              </div>

              <h3>Alocação (obrigatório):</h3> <mat-icon *ngIf="loading$ | async"><mat-spinner color="accent" diameter="20"> </mat-spinner> </mat-icon>
              <div class="alocacao-row">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Semestre</mat-label>
                    <mat-select formControlName="semestre" (selectionChange)="hrRestantes(0)" required>
                      <mat-option value="0">Selecione o semestre:</mat-option>
                      <mat-option value="1">1o Semestre</mat-option>
                      <mat-option value="2">2o Semestre</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Ano</mat-label>
                    <mat-select formControlName="ano" (selectionChange)="hrRestantes(0)" required>
                      <mat-option value="0">Selecione o ano:</mat-option>
                      <mat-option value="{{ ano }}">{{ ano }}</mat-option>
                      <mat-option value="{{ ano+1 }}">{{ ano+1 }}</mat-option>
                      <mat-option value="{{ ano+2 }}">{{ ano+2 }}</mat-option>
                      <mat-option value="{{ ano+3 }}">{{ ano+3 }}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>

                <div class="hr-disponiveis" *ngIf="extra[1] != null">
                  <mat-icon matBadge="{{max_hr_semestrais_curso-extra[1]}}" matBadgeColor="accent" matTooltip="Horas disponíveis nesse semestre para {{tipoAtividade}}">assessment</mat-icon>
                </div>

                <div class="col">
                  <mat-form-field class="full-width" class="horas" appearance="outline">
                    <mat-label>Horas</mat-label>
                    <input matInput min="1" placeholder="Horas" type="number" (keyup)="confereSoma()" (keyup)="consultaHrAlocacoes(1,$event,0)" formControlName="horasSolicitadas" required/>
                    <mat-error *ngIf="cursoForm.controls['horasSolicitadas'].hasError('max')">
                      Máximo são <strong>{{max_hr_semestrais_curso}}h/semestre.</strong>
                    </mat-error>
                  </mat-form-field>
                  <button mat-button type="button" mat-icon-button *ngIf="excedeuHr" color="warn" matTooltip="Excedeu"><mat-icon>warning</mat-icon></button>
                  <button mat-button type="button" mat-icon-button (click)="alocacaoExtra = !alocacaoExtra"
                    *ngIf="!alocacaoExtra" [disabled]="cursoForm.controls.horasSolicitadas.errors?.max">
                    <mat-icon>add_circle</mat-icon>
                  </button>
                </div>
              </div>

              <ng-container *ngIf="alocacaoExtra">
                <div class="row">
                  <div class="col">
                    <mat-form-field class="full-width" appearance="outline">
                      <mat-label>Semestre</mat-label>
                      <mat-select formControlName="semestre1" (selectionChange)="hrRestantes(1)" required>
                        <mat-option value="0">Selecione o semestre:</mat-option>
                        <mat-option value="1">1o Semestre</mat-option>
                        <mat-option value="2">2o Semestre</mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>
                  <div class="col">
                    <mat-form-field class="full-width" appearance="outline">
                      <mat-label>Ano</mat-label>
                      <mat-select formControlName="ano1" (selectionChange)="hrRestantes(1)" required>
                        <mat-option value="0">Selecione o ano:</mat-option>
                        <mat-option value="{{ ano }}">{{ ano }}</mat-option>
                        <mat-option value="{{ ano+1 }}">{{ ano+1 }}</mat-option>
                        <mat-option value="{{ ano+2 }}">{{ ano+2 }}</mat-option>
                        <mat-option value="{{ ano+3 }}">{{ ano+3 }}</mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>

                  
                  <div class="hr-disponiveis" *ngIf="extra1[1] != null">
                    <mat-icon matBadge="{{max_hr_semestrais_curso-extra1[1]}}" matBadgeColor="accent" matTooltip="Horas disponíveis nesse semestre para {{tipoAtividade}}">assessment</mat-icon>
                  </div>

                  <div class="col">
                    <mat-form-field class="full-width" class="horas" appearance="outline">
                      <mat-label>Horas</mat-label>
                      <input matInput min="1" placeholder="Horas" type="number" (keyup)="confereSoma()" (keyup)="consultaHrAlocacoes(1,$event,1)" formControlName="horasSolicitadas1" required/>
                      <mat-error *ngIf="cursoForm.controls['horasSolicitadas1'].hasError('max')">
                        Máximo são <strong>60h/semestre.</strong>
                      </mat-error>
                    </mat-form-field>
                    <button mat-button type="button" mat-icon-button *ngIf="excedeuHr1" color="warn" matTooltip="Excedeu"><mat-icon>warning</mat-icon></button>
                    <button mat-button type="button" mat-icon-button (click)="alocacaoExtra2 = !alocacaoExtra2"
                      *ngIf="!alocacaoExtra2" [disabled]="cursoForm.controls.horasSolicitadas1.errors?.max">
                      <mat-icon>add_circle</mat-icon>
                    </button>
                    <button mat-button type="button" mat-icon-button aria-label="Clear"
                      (click)="alocacaoExtra = !alocacaoExtra" (click)="resetHrExtra(1)">
                      <mat-icon>remove_circle_outline</mat-icon>
                    </button>
                  </div>
                </div>
              </ng-container>

              <div class="row" *ngIf="alocacaoExtra2">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Semestre</mat-label>
                    <mat-select formControlName="semestre2" (selectionChange)="hrRestantes(2)" required>
                      <mat-option value="0">Selecione o semestre:</mat-option>
                      <mat-option value="1">1o Semestre</mat-option>
                      <mat-option value="2">2o Semestre</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Ano</mat-label>
                    <mat-select formControlName="ano2" (selectionChange)="hrRestantes(2)" required>
                      <mat-option value="0">Selecione o ano:</mat-option>
                      <mat-option value="{{ ano }}">{{ ano }}</mat-option>
                      <mat-option value="{{ ano+1 }}">{{ ano+1 }}</mat-option>
                      <mat-option value="{{ ano+2 }}">{{ ano+2 }}</mat-option>
                      <mat-option value="{{ ano+3 }}">{{ ano+3 }}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>

                <div class="hr-disponiveis" *ngIf="extra2[1] != null">
                  <mat-icon matBadge="{{max_hr_semestrais_curso-extra2[1]}}" matBadgeColor="accent" matTooltip="Horas disponíveis nesse semestre para {{tipoAtividade}}">assessment</mat-icon>
                </div>

                <div class="col">
                  <mat-form-field class="full-width" class="horas" appearance="outline">
                    <mat-label>Horas</mat-label>
                    <input matInput min="1" placeholder="Horas" type="number" (keyup)="confereSoma()" (keyup)="consultaHrAlocacoes(1,$event,2)" formControlName="horasSolicitadas2" required/>
                    <mat-error *ngIf="cursoForm.controls['horasSolicitadas2'].hasError('max')">
                      Máximo são <strong>60h/semestre.</strong>
                    </mat-error>
                  </mat-form-field>
                  <button mat-button type="button" mat-icon-button *ngIf="excedeuHr2" color="warn" matTooltip="Excedeu"><mat-icon>warning</mat-icon></button>
                  <button mat-button type="button" mat-icon-button (click)="alocacaoExtra3 = !alocacaoExtra3"
                    *ngIf="!alocacaoExtra3" [disabled]="cursoForm.controls.horasSolicitadas2.errors?.max">
                    <mat-icon>add_circle</mat-icon>
                  </button>
                  <button mat-button type="button" mat-icon-button aria-label="Clear"
                    (click)="alocacaoExtra2 = !alocacaoExtra2" (click)="resetHrExtra(2)">
                    <mat-icon>remove_circle_outline</mat-icon>
                  </button>
                </div>
              </div>

              <div class="row" *ngIf="alocacaoExtra3">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Semestre</mat-label>
                    <mat-select formControlName="semestre3" (selectionChange)="hrRestantes(3)" required>
                      <mat-option value="0">Selecione o semestre:</mat-option>
                      <mat-option value="1">1o Semestre</mat-option>
                      <mat-option value="2">2o Semestre</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Ano</mat-label>
                    <mat-select formControlName="ano3" (selectionChange)="hrRestantes(3)" required>
                      <mat-option value="0">Selecione o ano:</mat-option>
                      <mat-option value="{{ ano }}">{{ ano }}</mat-option>
                      <mat-option value="{{ ano+1 }}">{{ ano+1 }}</mat-option>
                      <mat-option value="{{ ano+2 }}">{{ ano+2 }}</mat-option>
                      <mat-option value="{{ ano+3 }}">{{ ano+3 }}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>

                <div class="hr-disponiveis" *ngIf="extra3[1] != null">
                  <mat-icon matBadge="{{max_hr_semestrais_curso-extra3[1]}}" matBadgeColor="accent" matTooltip="Horas disponíveis nesse semestre para {{tipoAtividade}}">assessment</mat-icon>
                </div>

                <div class="col">
                  <mat-form-field class="full-width" class="horas" appearance="outline">
                    <mat-label>Horas</mat-label>
                    <input matInput min="1" placeholder="horasSolicitadas3" type="number" (keyup)="confereSoma()" (keyup)="consultaHrAlocacoes(1,$event,3)" formControlName="horasSolicitadas3" required/>
                    <mat-error *ngIf="cursoForm.controls['horasSolicitadas3'].hasError('max')">
                      Máximo são <strong>60h/semestre.</strong>
                    </mat-error>
                  </mat-form-field>
                  <button mat-button type="button" mat-icon-button *ngIf="excedeuHr3" color="warn" matTooltip="Excedeu"><mat-icon>warning</mat-icon></button>
                  <button mat-button type="button" mat-icon-button (click)="alocacaoExtra4 = !alocacaoExtra4"
                    *ngIf="!alocacaoExtra4" [disabled]="cursoForm.controls.horasSolicitadas3.errors?.max">
                    <mat-icon>add_circle</mat-icon>
                  </button>
                  <button mat-button type="button" mat-icon-button aria-label="Clear"
                    (click)="alocacaoExtra3 = !alocacaoExtra3" (click)="resetHrExtra(3)">
                    <mat-icon>remove_circle_outline</mat-icon>
                  </button>
                </div>
              </div>

              <div class="row" *ngIf="alocacaoExtra4">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Semestre</mat-label>
                    <mat-select formControlName="semestre4" (selectionChange)="hrRestantes(4)" required>
                      <mat-option value="0">Selecione o semestre:</mat-option>
                      <mat-option value="1">1o Semestre</mat-option>
                      <mat-option value="2">2o Semestre</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Ano</mat-label>
                    <mat-select formControlName="ano4" (selectionChange)="hrRestantes(4)" required>
                      <mat-option value="0">Selecione o ano:</mat-option>
                      <mat-option value="{{ ano }}">{{ ano }}</mat-option>
                      <mat-option value="{{ ano+1 }}">{{ ano+1 }}</mat-option>
                      <mat-option value="{{ ano+2 }}">{{ ano+2 }}</mat-option>
                      <mat-option value="{{ ano+3 }}">{{ ano+3 }}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>

                <div class="hr-disponiveis" *ngIf="extra4[1] != null">
                  <mat-icon matBadge="{{max_hr_semestrais_curso-extra4[1]}}" matBadgeColor="accent" matTooltip="Horas disponíveis nesse semestre para {{tipoAtividade}}">assessment</mat-icon>
                </div>

                <div class="col">
                  <mat-form-field class="full-width" class="horas" appearance="outline">
                    <mat-label>Horas</mat-label>
                    <input matInput min="1" placeholder="horasSolicitadas4" type="number" (keyup)="confereSoma()" (keyup)="consultaHrAlocacoes(1,$event,4)" formControlName="horasSolicitadas4" required/>
                    <mat-error *ngIf="cursoForm.controls['horasSolicitadas4'].hasError('max')">
                      Máximo são <strong>60h/semestre.</strong>
                    </mat-error>
                  </mat-form-field>
                  <button mat-button type="button" mat-icon-button *ngIf="excedeuHr4" color="warn" matTooltip="Excedeu"><mat-icon>warning</mat-icon></button>
                  <button mat-button type="button" mat-icon-button (click)="alocacaoExtra5 = !alocacaoExtra5"
                    *ngIf="!alocacaoExtra5" [disabled]="cursoForm.controls.horasSolicitadas4.errors?.max">
                    <mat-icon>add_circle</mat-icon>
                  </button>
                  <button mat-button type="button" mat-icon-button aria-label="Clear"
                    (click)="alocacaoExtra4 = !alocacaoExtra4" (click)="resetHrExtra(4)">
                    <mat-icon>remove_circle_outline</mat-icon>
                  </button>
                </div>
              </div>

              <div class="row" *ngIf="alocacaoExtra5">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Semestre</mat-label>
                    <mat-select formControlName="semestre5" (selectionChange)="hrRestantes(5)" required>
                      <mat-option value="0">Selecione o semestre:</mat-option>
                      <mat-option value="1">1o Semestre</mat-option>
                      <mat-option value="2">2o Semestre</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Ano</mat-label>
                    <mat-select formControlName="ano5" (selectionChange)="hrRestantes(5)" required>
                      <mat-option value="0">Selecione o ano:</mat-option>
                      <mat-option value="{{ ano }}">{{ ano }}</mat-option>
                      <mat-option value="{{ ano+1 }}">{{ ano+1 }}</mat-option>
                      <mat-option value="{{ ano+2 }}">{{ ano+2 }}</mat-option>
                      <mat-option value="{{ ano+3 }}">{{ ano+3 }}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>

                <div class="hr-disponiveis" *ngIf="extra5[1] != null">
                  <mat-icon matBadge="{{max_hr_semestrais_curso-extra5[1]}}" matBadgeColor="accent" matTooltip="Horas disponíveis nesse semestre para {{tipoAtividade}}">assessment</mat-icon>
                </div>

                <div class="col">
                  <mat-form-field class="full-width" class="horas" appearance="outline">
                    <mat-label>Horas</mat-label>
                    <input matInput min="1" placeholder="horasSolicitadas5" type="number" (keyup)="confereSoma()" (keyup)="consultaHrAlocacoes(1,$event,5)" formControlName="horasSolicitadas5" required/>
                    <mat-error *ngIf="cursoForm.controls['horasSolicitadas5'].hasError('max')">
                      Máximo são <strong>60h/semestre.</strong>
                    </mat-error>
                  </mat-form-field>
                  <button mat-button type="button" mat-icon-button *ngIf="excedeuHr5" color="warn" matTooltip="Excedeu"><mat-icon>warning</mat-icon></button>
                  <button mat-button type="button" mat-icon-button aria-label="Clear"
                    (click)="alocacaoExtra5 = !alocacaoExtra5" (click)="resetHrExtra(5)"
                    [disabled]="cursoForm.controls.horasSolicitadas5.errors?.max">
                    <mat-icon>remove_circle_outline</mat-icon>
                  </button>
                </div>
              </div>

              <h3>Observações (opcional):</h3>
              <div class="row">
                <div class="col">
                  <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Incluir observação</mat-label>
                    <textarea matInput formControlName="observacao"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row" style="margin-bottom: 20px;">
                <div class="col">
                  <mat-slide-toggle formControlName="urgente">Urgente</mat-slide-toggle>
                </div>
              </div>
              <!-- <div class="row">
                <div class="col">
                  <label class="btn btn-default">
                    <input type="file" (change)="selecionarArquivo($event)" />
                  </label>
                </div>
              </div> -->
            </mat-card-content>
            <mat-card-actions>
              <button [disabled]="!cursoForm.valid || totalHrSolicitadas != somaHrCurso" mat-raised-button color="primary"
                (click)="submeterCurso(); cursoForm.reset()" *ngIf="!excedeuHr && !excedeuHr1 && !excedeuHr2 && !excedeuHr3 && !excedeuHr4 && !excedeuHr5">Enviar</button>

                <button [disabled]="!cursoForm.valid || totalHrSolicitadas != somaHrCurso" mat-raised-button color="primary"
                *ngIf="excedeuHr || excedeuHr1 || excedeuHr2 || excedeuHr3 || excedeuHr4 || excedeuHr5" matBadge="⚠" matBadgeColor="accent"
                (click)="submeterCurso(); cursoForm.reset()">Enviar</button>                
            </mat-card-actions>
            <mat-card-actions>
              <mat-error *ngIf="!cursoForm.valid">Existem campos obrigatórios sem preencher ou incorretos. <button mat-button (click)="cursoForm.markAllAsTouched();">Quais?</button></mat-error>
              <mat-error *ngIf="totalHrSolicitadas != somaHrCurso">Total de horas alocadas não batem.</mat-error>
            </mat-card-actions>
          </mat-card>
        </form>
      </mat-expansion-panel>

      <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
        <mat-expansion-panel-header (focus)="definetipoAtividade('Regência Concomitante')">
          <mat-panel-title> Regência Concomitante </mat-panel-title>
          <mat-panel-description>
            Submeter atividades relacionadas a Regência Concomitante
          </mat-panel-description>
        </mat-expansion-panel-header>
        <form name="form" [formGroup]="regenciaForm" #f="ngForm">
          <mat-card class="mat-elevation-z0">
            <mat-card-content>
              <div class="row">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Nome do curso (obrigatório):</mat-label>
                    <input matInput placeholder="Nome do curso" formControlName="curso" />
                    <mat-error *ngIf="regenciaForm.controls['curso'].hasError('required')">
                      Nome do curso <strong>obrigatório</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Instituição de Ensino Vinculada (obrigatório):</mat-label>
                    <input matInput placeholder="Instituição vinculada" formControlName="instituicao" />
                    <mat-error *ngIf="regenciaForm.controls['instituicao'].hasError('required')">
                      Nome da instituição <strong>obrigatório</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Coordenador(a) (opcional):</mat-label>
                    <input matInput placeholder="Coordenador(a) (opcional)" formControlName="coordenador" />
                  </mat-form-field>
                </div>
              </div>
              <div class="row">
                <mat-label style="margin-right: 20px">Nível (obrigatório):</mat-label>
                <mat-radio-group aria-label="Select an option" formControlName="nivel">
                  <mat-radio-button value="GRADUACAO">Graduação</mat-radio-button>
                  <mat-radio-button value="POS_GRADUACAO">Pós-Graduação</mat-radio-button>
                </mat-radio-group>
                <mat-error *ngIf="regenciaForm.controls['nivel'].hasError('required')">Campo obrigatório.</mat-error>
              </div>
              <div class="row">
                <mat-label style="margin-right: 20px">Será o responsável pela disciplina (obrigatório):
                </mat-label>
                <mat-radio-group aria-label="Select an option" formControlName="responsavel">
                  <mat-radio-button [value]="true">Sim</mat-radio-button>
                  <mat-radio-button [value]="false">Não</mat-radio-button>
                </mat-radio-group>
                <mat-error *ngIf="regenciaForm.controls['responsavel'].hasError('required')">Campo obrigatório.</mat-error>
              </div>
              <div class="row">
                <mat-label style="margin-right: 20px">Será o único docente da disciplina (obrigatório):
                </mat-label>
                <mat-radio-group aria-label="Select an option" formControlName="unicoDocente">
                  <mat-radio-button [value]="true">Sim</mat-radio-button>
                  <mat-radio-button [value]="false">Não</mat-radio-button>
                </mat-radio-group>
                <mat-error *ngIf="regenciaForm.controls['unicoDocente'].hasError('required')">Campo obrigatório.</mat-error>
              </div>
              <div class="row" style="margin-top: 5px">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Disciplina de participação (opcional):</mat-label>
                    <input matInput placeholder="Disciplina" formControlName="disciplinaParticipacao" />
                  </mat-form-field>
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Carga horária total de aulas ministradas (opcional):</mat-label>
                    <input matInput maxlength="5" min="1" placeholder="Carga horária total" type="number" [(ngModel)]="hrTotalMinistradaRegencia"
                      formControlName="totalHorasMinistradas" (keyup)="updateSomaHrRegencia()"/>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Carga horária total de outras atividades (obrigatório):</mat-label>
                    <input matInput maxlength="5" min="1" placeholder="totalHorasOutrasAtividades" type="number" [(ngModel)]="hrTotalOutrasRegencia"
                      formControlName="totalHorasOutrasAtividades" (keyup)="updateSomaHrRegencia()" required/>
                  </mat-form-field>
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Valor bruto por hora (R$) (obrigatório):</mat-label>
                    <input matInput maxlength="5" placeholder="Valor bruto hora-aula" type="number"
                      formControlName="valorBrutoHora" />
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Valor bruto total (R$) (obrigatório):</mat-label>
                    <input matInput maxlength="5" placeholder="Valor bruto total aulas" type="number"
                      formControlName="valorBrutoTotal" />
                  </mat-form-field>
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <!--[min]="minDateIni" [max]="maxDateIni"-->
                  <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Data Inicio (obrigatório):</mat-label>
                    <input matInput [matDatepicker]="picker4" formControlName="dataInicio" placeholder="Selecionar data"
                      required />
                    <mat-datepicker-toggle matSuffix [for]="picker4"></mat-datepicker-toggle>
                    <mat-datepicker #picker4></mat-datepicker>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Data Fim (obrigatório):</mat-label>
                    <input matInput [matDatepicker]="picker5" formControlName="dataFim" placeholder="Selecionar data"
                    [min]="minDateFim" required />
                    <mat-datepicker-toggle matSuffix [for]="picker5"></mat-datepicker-toggle>
                    <mat-datepicker #picker5></mat-datepicker>
                  </mat-form-field>
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Incluir observação (opcional):</mat-label>
                    <textarea matInput formControlName="observacao"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Dias Trabalhados Unicamp (obrigatório):</mat-label>
                    <input matInput placeholder="Dias Trabalhados Unicamp" formControlName="diasTrabalhadosUnicamp"
                      type="number" />
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Dias trabalhados em outra instituicao (obrigatório):</mat-label>
                    <input matInput placeholder="Dias trabalhados em outra instituicao"
                      formControlName="diasTrabalhadosOutraInstituicao" type="number" />
                  </mat-form-field>
                </div>
              </div>

              <h3>Alocação (obrigatório):</h3> <mat-icon *ngIf="loading$ | async"><mat-spinner color="accent" diameter="20"> </mat-spinner> </mat-icon>
              <div class="alocacao-row">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Semestre</mat-label>
                    <mat-select formControlName="semestre" (selectionChange)="hrRestantes(0)" required>
                      <mat-option value="0">Selecione o semestre:</mat-option>
                      <mat-option value="1">1o Semestre</mat-option>
                      <mat-option value="2">2o Semestre</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Ano</mat-label>
                    <mat-select formControlName="ano" (selectionChange)="hrRestantes(0)" required>
                      <mat-option value="0">Selecione o ano:</mat-option>
                      <mat-option value="{{ ano }}">{{ ano }}</mat-option>
                      <mat-option value="{{ ano+1 }}">{{ ano+1 }}</mat-option>
                      <mat-option value="{{ ano+2 }}">{{ ano+2 }}</mat-option>
                      <mat-option value="{{ ano+3 }}">{{ ano+3 }}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>

                <div class="hr-disponiveis" *ngIf="extra[2] != null">
                  <mat-icon matBadge="{{max_hr_semestrais_regencia-extra[2]}}" matBadgeColor="accent" matTooltip="Horas disponíveis nesse semestre para {{tipoAtividade}}">assessment</mat-icon>
                </div>

                <div class="col">
                  <mat-form-field class="full-width" class="horas" appearance="outline">
                    <mat-label>Horas</mat-label>
                    <input matInput min="1" placeholder="horasSolicitadas" type="number" (keyup)="confereSoma()" (keyup)="consultaHrAlocacoes(1,$event,0)" formControlName="horasSolicitadas" required/>
                    <mat-error *ngIf="regenciaForm.controls['horasSolicitadas'].hasError('max')">
                      Máximo são <strong>{{max_hr_semestrais_regencia}}h/semestre.</strong>
                    </mat-error>
                  </mat-form-field>
                  <button mat-button type="button" mat-icon-button *ngIf="excedeuHr" color="warn" matTooltip="Excedeu"><mat-icon>warning</mat-icon></button>
                  <button mat-button type="button" mat-icon-button (click)="alocacaoExtra = !alocacaoExtra"
                    *ngIf="!alocacaoExtra" [disabled]="regenciaForm.controls.horasSolicitadas.errors?.max">
                    <mat-icon>add_circle</mat-icon>
                  </button>
                </div>
              </div>

              <ng-container *ngIf="alocacaoExtra">
                <div class="row">
                  <div class="col">
                    <mat-form-field class="full-width" appearance="outline">
                      <mat-label>Semestre</mat-label>
                      <mat-select formControlName="semestre1" (selectionChange)="hrRestantes(1)" required>
                        <mat-option value="0">Selecione o semestre:</mat-option>
                        <mat-option value="1">1o Semestre</mat-option>
                        <mat-option value="2">2o Semestre</mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>
                  <div class="col">
                    <mat-form-field class="full-width" appearance="outline">
                      <mat-label>Ano</mat-label>
                      <mat-select formControlName="ano1" (selectionChange)="hrRestantes(1)" required>
                        <mat-option value="0">Selecione o ano:</mat-option>
                        <mat-option value="{{ ano }}">{{ ano }}</mat-option>
                        <mat-option value="{{ ano+1 }}">{{ ano+1 }}</mat-option>
                        <mat-option value="{{ ano+2 }}">{{ ano+2 }}</mat-option>
                        <mat-option value="{{ ano+3 }}">{{ ano+3 }}</mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>

                  <div class="hr-disponiveis" *ngIf="extra1[2] != null">
                    <mat-icon matBadge="{{max_hr_semestrais_regencia-extra1[2]}}" matBadgeColor="accent" matTooltip="Horas disponíveis nesse semestre para {{tipoAtividade}}">assessment</mat-icon>
                  </div>

                  <div class="col">
                    <mat-form-field class="full-width" class="horas" appearance="outline">
                      <mat-label>Horas</mat-label>
                      <input matInput min="1" placeholder="horasSolicitadas1" type="number" (keyup)="confereSoma()" (keyup)="consultaHrAlocacoes(1,$event,1)" formControlName="horasSolicitadas1" required/>
                      <mat-error *ngIf="regenciaForm.controls['horasSolicitadas1'].hasError('max')">
                        Máximo são <strong>60h/semestre.</strong>
                      </mat-error>
                    </mat-form-field>
                    <button mat-button type="button" mat-icon-button *ngIf="excedeuHr1" color="warn" matTooltip="Excedeu"><mat-icon>warning</mat-icon></button>
                    <button mat-button type="button" mat-icon-button (click)="alocacaoExtra2 = !alocacaoExtra2"
                      *ngIf="!alocacaoExtra2" [disabled]="regenciaForm.controls.horasSolicitadas1.errors?.max">
                      <mat-icon>add_circle</mat-icon>
                    </button>
                    <button mat-button type="button" mat-icon-button aria-label="Clear"
                      (click)="alocacaoExtra = !alocacaoExtra" (click)="resetHrExtra(1)">
                      <mat-icon>remove_circle_outline</mat-icon>
                    </button>
                  </div>
                </div>
              </ng-container>

              <div class="row" *ngIf="alocacaoExtra2">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Semestre</mat-label>
                    <mat-select formControlName="semestre2" (selectionChange)="hrRestantes(2)" required>
                      <mat-option value="0">Selecione o semestre:</mat-option>
                      <mat-option value="1">1o Semestre</mat-option>
                      <mat-option value="2">2o Semestre</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Ano</mat-label>
                    <mat-select formControlName="ano2" (selectionChange)="hrRestantes(2)" required>
                      <mat-option value="0">Selecione o ano:</mat-option>
                      <mat-option value="{{ ano }}">{{ ano }}</mat-option>
                      <mat-option value="{{ ano+1 }}">{{ ano+1 }}</mat-option>
                      <mat-option value="{{ ano+2 }}">{{ ano+2 }}</mat-option>
                      <mat-option value="{{ ano+3 }}">{{ ano+3 }}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>

                <div class="hr-disponiveis" *ngIf="extra2[2] != null">
                  <mat-icon matBadge="{{max_hr_semestrais_regencia-extra2[2]}}" matBadgeColor="accent" matTooltip="Horas disponíveis nesse semestre para {{tipoAtividade}}">assessment</mat-icon>
                </div>

                <div class="col">
                  <mat-form-field class="full-width" class="horas" appearance="outline">
                    <mat-label>Horas</mat-label>
                    <input matInput min="1" placeholder="horasSolicitadas2" type="number" (keyup)="confereSoma()" (keyup)="consultaHrAlocacoes(1,$event,2)" formControlName="horasSolicitadas2" required/>
                    <mat-error *ngIf="regenciaForm.controls['horasSolicitadas2'].hasError('max')">
                      Máximo são <strong>60h/semestre.</strong>
                    </mat-error>
                  </mat-form-field>
                  <button mat-button type="button" mat-icon-button *ngIf="excedeuHr2" color="warn" matTooltip="Excedeu"><mat-icon>warning</mat-icon></button>
                  <button mat-button type="button" mat-icon-button (click)="alocacaoExtra3 = !alocacaoExtra3"
                    *ngIf="!alocacaoExtra3" [disabled]="regenciaForm.controls.horasSolicitadas2.errors?.max">
                    <mat-icon>add_circle</mat-icon>
                  </button>
                  <button mat-button type="button" mat-icon-button aria-label="Clear"
                    (click)="alocacaoExtra2 = !alocacaoExtra2" (click)="resetHrExtra(2)">
                    <mat-icon>remove_circle_outline</mat-icon>
                  </button>
                </div>
              </div>

              <div class="row" *ngIf="alocacaoExtra3">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Semestre</mat-label>
                    <mat-select formControlName="semestre3" (selectionChange)="hrRestantes(3)" required>
                      <mat-option value="0">Selecione o semestre:</mat-option>
                      <mat-option value="1">1o Semestre</mat-option>
                      <mat-option value="2">2o Semestre</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Ano</mat-label>
                    <mat-select formControlName="ano3" (selectionChange)="hrRestantes(3)" required>
                      <mat-option value="0">Selecione o ano:</mat-option>
                      <mat-option value="{{ ano }}">{{ ano }}</mat-option>
                      <mat-option value="{{ ano+1 }}">{{ ano+1 }}</mat-option>
                      <mat-option value="{{ ano+2 }}">{{ ano+2 }}</mat-option>
                      <mat-option value="{{ ano+3 }}">{{ ano+3 }}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>

                <div class="hr-disponiveis" *ngIf="extra3[2] != null">
                  <mat-icon matBadge="{{max_hr_semestrais_regencia-extra3[2]}}" matBadgeColor="accent" matTooltip="Horas disponíveis nesse semestre para {{tipoAtividade}}">assessment</mat-icon>
                </div>

                <div class="col">
                  <mat-form-field class="full-width" class="horas" appearance="outline">
                    <mat-label>Horas</mat-label>
                    <input matInput min="1" placeholder="horasSolicitadas3" type="number" (keyup)="confereSoma()" (keyup)="consultaHrAlocacoes(1,$event,3)" formControlName="horasSolicitadas3" required/>
                    <mat-error *ngIf="regenciaForm.controls['horasSolicitadas3'].hasError('max')">
                      Máximo são <strong>60h/semestre.</strong>
                    </mat-error>
                  </mat-form-field>
                  <button mat-button type="button" mat-icon-button *ngIf="excedeuHr3" color="warn" matTooltip="Excedeu"><mat-icon>warning</mat-icon></button>
                  <button mat-button type="button" mat-icon-button (click)="alocacaoExtra4 = !alocacaoExtra4"
                    *ngIf="!alocacaoExtra4" [disabled]="regenciaForm.controls.horasSolicitadas3.errors?.max">
                    <mat-icon>add_circle</mat-icon>
                  </button>
                  <button mat-button type="button" mat-icon-button aria-label="Clear"
                    (click)="alocacaoExtra3 = !alocacaoExtra3" (click)="resetHrExtra(3)">
                    <mat-icon>remove_circle_outline</mat-icon>
                  </button>
                </div>
              </div>

              <div class="row" *ngIf="alocacaoExtra4">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Semestre</mat-label>
                    <mat-select formControlName="semestre4" (selectionChange)="hrRestantes(4)" required>
                      <mat-option value="0">Selecione o semestre:</mat-option>
                      <mat-option value="1">1o Semestre</mat-option>
                      <mat-option value="2">2o Semestre</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Ano</mat-label>
                    <mat-select formControlName="ano4" (selectionChange)="hrRestantes(4)" required>
                      <mat-option value="0">Selecione o ano:</mat-option>
                      <mat-option value="{{ ano }}">{{ ano }}</mat-option>
                      <mat-option value="{{ ano+1 }}">{{ ano+1 }}</mat-option>
                      <mat-option value="{{ ano+2 }}">{{ ano+2 }}</mat-option>
                      <mat-option value="{{ ano+3 }}">{{ ano+3 }}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>

                <div class="hr-disponiveis" *ngIf="extra4[2] != null">
                  <mat-icon matBadge="{{max_hr_semestrais_regencia-extra4[2]}}" matBadgeColor="accent" matTooltip="Horas disponíveis nesse semestre para {{tipoAtividade}}">assessment</mat-icon>
                </div>

                <div class="col">
                  <mat-form-field class="full-width" class="horas" appearance="outline">
                    <mat-label>Horas</mat-label>
                    <input matInput min="1" placeholder="horasSolicitadas4" type="number" (keyup)="confereSoma()" (keyup)="consultaHrAlocacoes(1,$event,4)" formControlName="horasSolicitadas4" required/>
                    <mat-error *ngIf="regenciaForm.controls['horasSolicitadas4'].hasError('max')">
                      Máximo são <strong>60h/semestre.</strong>
                    </mat-error>
                  </mat-form-field>
                  <button mat-button type="button" mat-icon-button *ngIf="excedeuHr4" color="warn" matTooltip="Excedeu"><mat-icon>warning</mat-icon></button>
                  <button mat-button type="button" mat-icon-button (click)="alocacaoExtra5 = !alocacaoExtra5"
                    *ngIf="!alocacaoExtra5" [disabled]="regenciaForm.controls.horasSolicitadas4.errors?.max">
                    <mat-icon>add_circle</mat-icon>
                  </button>
                  <button mat-button type="button" mat-icon-button aria-label="Clear"
                    (click)="alocacaoExtra4 = !alocacaoExtra4" (click)="resetHrExtra(4)">
                    <mat-icon>remove_circle_outline</mat-icon>
                  </button>
                </div>
              </div>

              <div class="row" *ngIf="alocacaoExtra5">
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Semestre</mat-label>
                    <mat-select formControlName="semestre5" (selectionChange)="hrRestantes(5)" required>
                      <mat-option value="0">Selecione o semestre:</mat-option>
                      <mat-option value="1">1o Semestre</mat-option>
                      <mat-option value="2">2o Semestre</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col">
                  <mat-form-field class="full-width" appearance="outline">
                    <mat-label>Ano</mat-label>
                    <mat-select formControlName="ano5" (selectionChange)="hrRestantes(5)" required>
                      <mat-option value="0">Selecione o ano:</mat-option>
                      <mat-option value="{{ ano }}">{{ ano }}</mat-option>
                      <mat-option value="{{ ano+1 }}">{{ ano+1 }}</mat-option>
                      <mat-option value="{{ ano+2 }}">{{ ano+2 }}</mat-option>
                      <mat-option value="{{ ano+3 }}">{{ ano+3 }}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>

                <div class="hr-disponiveis" *ngIf="extra5[2] != null">
                  <mat-icon matBadge="{{max_hr_semestrais_regencia-extra5[2]}}" matBadgeColor="accent" matTooltip="Horas disponíveis nesse semestre para {{tipoAtividade}}">assessment</mat-icon>
                </div>

                <div class="col">
                  <mat-form-field class="full-width" class="horas" appearance="outline">
                    <mat-label>Horas</mat-label>
                    <input matInput min="1" placeholder="horasSolicitadas5" type="number" (keyup)="confereSoma()" (keyup)="consultaHrAlocacoes(1,$event,5)" formControlName="horasSolicitadas5" required/>
                    <mat-error *ngIf="regenciaForm.controls['horasSolicitadas5'].hasError('max')">
                      Máximo são <strong>60h/semestre.</strong>
                    </mat-error>
                  </mat-form-field>
                  <button mat-button type="button" mat-icon-button *ngIf="excedeuHr5" color="warn" matTooltip="Excedeu"><mat-icon>warning</mat-icon></button>
                  <button mat-button type="button" mat-icon-button aria-label="Clear"
                    (click)="alocacaoExtra5 = !alocacaoExtra5" (click)="resetHrExtra(5)"
                    [disabled]="regenciaForm.controls.horasSolicitadas5.errors?.max">
                    <mat-icon>remove_circle_outline</mat-icon>
                  </button>
                </div>
              </div>


              <h3>Observações (opcional):</h3>
              <div class="row">
                <div class="col">
                  <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Incluir observação</mat-label>
                    <textarea matInput formControlName="observacao"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row" style="margin-bottom: 20px;">
                <div class="col">
                  <mat-slide-toggle formControlName="urgente">Urgente</mat-slide-toggle>
                </div>
              </div>
              <!-- <div class="row">
                <div class="col">
                  <label class="btn btn-default">
                    <input type="file" (change)="selecionarArquivo($event)" />
                  </label>
                </div>
              </div> -->
            </mat-card-content>
            <mat-card-actions>
              <button [disabled]="!regenciaForm.valid || totalHrSolicitadas != somaHrRegencia" mat-raised-button color="primary"
                (click)="submeterRegencia()" *ngIf="!excedeuHr && !excedeuHr1 && !excedeuHr2 && !excedeuHr3 && !excedeuHr4 && !excedeuHr5">
                Enviar
              </button>

              <button [disabled]="!regenciaForm.valid || totalHrSolicitadas != somaHrRegencia" mat-raised-button color="primary"
                (click)="submeterRegencia()" *ngIf="excedeuHr || excedeuHr1 || excedeuHr2 || excedeuHr3 || excedeuHr4 || excedeuHr5" matBadge="⚠" matBadgeColor="accent">
                Enviar
              </button>
              
            </mat-card-actions>
            <mat-card-actions>
              <mat-error *ngIf="!regenciaForm.valid">Existem campos obrigatórios sem preencher ou incorretos. <button mat-button (click)="regenciaForm.markAllAsTouched();">Quais?</button></mat-error>
              <mat-error *ngIf="totalHrSolicitadas != somaHrRegencia">Total de horas alocadas não batem.</mat-error>
            </mat-card-actions>
          </mat-card>
        </form>
      </mat-expansion-panel>
    </mat-accordion>
  </mat-card>
</div>